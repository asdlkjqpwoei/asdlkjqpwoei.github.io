{
    "version": "https://jsonfeed.org/version/1",
    "title": "Jager的工地 • All posts by \"linux\" category",
    "description": "游戏开发",
    "home_page_url": "https://asdlkjqpwoei.github.io",
    "items": [
        {
            "id": "https://asdlkjqpwoei.github.io/2024/05/09/ArchLinuxInstallation/",
            "url": "https://asdlkjqpwoei.github.io/2024/05/09/ArchLinuxInstallation/",
            "title": "Arch Linux Installation",
            "date_published": "2024-05-09T14:33:29.072Z",
            "content_html": "<p>大学时玩多个Linux发行版，是Arch Linux比较符合我的胃口，虽然说入门相比其他发行版有点困难，在单个物理机上装了Windows和Arch Linux双系统，但是其中学到了一些东西。工作以后玩得少了，由于没有两台物理机，我也没什么必要用双系统了，因为多数时候还是在Windows平台上进行开发，换了新硬盘，不用Linux了，做个纪念。</p>\n<h1 id=\"Installation-Medium\"><a href=\"#Installation-Medium\" class=\"headerlink\" title=\"Installation Medium\"></a>Installation Medium</h1><p>可以用一个无重要数据的U盘作为启动盘，需要一个制作启动盘的工具，我用的是Rufus，在Arch Linux下载安装镜像后，用制作工具将U盘制作成启动盘。</p>\n<h1 id=\"Boot-the-live-environment\"><a href=\"#Boot-the-live-environment\" class=\"headerlink\" title=\"Boot the live environment\"></a>Boot the live environment</h1><p>根据自己计算机主板的供应商品牌，找到进入BIOS或UEFI的办法，通常是在启动后按键盘上的某一个键（Del或者F9，具体需要参考说明书或操作手册）。进入后修改启动顺序，使U盘启动盘为第一个启动的设备，具体需要参考主板的说明书或者操作手册。<br>Arch Linux安装镜像不支持安全启动(Secure Boot)，在进入UEFI以后需要安全启动，通常默认为开启。</p>\n<h1 id=\"Verify-the-boot-mode\"><a href=\"#Verify-the-boot-mode\" class=\"headerlink\" title=\"Verify the boot mode\"></a>Verify the boot mode</h1><p>目前最新的引导启动模式为UEFI，旧的一般为BIOS，可通过命令行检查引导启动模式：<code>cat /sys/firmware/efi/fw_platform_size</code>，或者查阅主板的说明书或操作手册</p>\n<p>如果返回值为64，那么引导启动模式为UEFI，并且是64位 x64 UEFI。如果返回值为32，那么引导启动模式为UEFI，并且是32位 x32 UEFI。如果提示文件不存在，那么启动模式可能为BIOS。</p>\n<h1 id=\"Set-the-console-keyboard-layout-and-font\"><a href=\"#Set-the-console-keyboard-layout-and-font\" class=\"headerlink\" title=\"Set the console keyboard layout and font\"></a>Set the console keyboard layout and font</h1><p>默认的命令行键盘布局为标准的美国键盘布局，对于我们来说一般不用动。</p>\n<h1 id=\"Connet-to-the-Internet\"><a href=\"#Connet-to-the-Internet\" class=\"headerlink\" title=\"Connet to the Internet\"></a>Connet to the Internet</h1><p>可以通过命令<code>ip link</code>查看网络接口状况。</p>\n<p>有线网络通常不太需要关注网络连接问题，因为一般在进入安装环境后就有网络了，可以通过命令<code>dhcp</code>保证网络连接或者查错。</p>\n<p>但是无线网络可能需要通过命令<code>iwctl</code>自行连接。</p>\n<p>可以通过命令<code>ping &lt;URL&gt;</code>来检查网络是否畅通。</p>\n<h1 id=\"Update-the-system-lock\"><a href=\"#Update-the-system-lock\" class=\"headerlink\" title=\"Update the system lock\"></a>Update the system lock</h1><p>可通过命令<code>timedatectl</code>进行网络时间同步，保证操作系统时间正确。</p>\n<h1 id=\"Partition-the-disk\"><a href=\"#Partition-the-disk\" class=\"headerlink\" title=\"Partition the disk\"></a>Partition the disk</h1><p>操作系统识别到存储硬件后，就会为其分配一个块设备，如&#x2F;dev&#x2F;sda，可以通过命令行<code>lsblk</code>或<code>fdisk</code>来进行查看硬盘状况。</p>\n<p>Arch Linux的安装环境提供了不同的分区管理工具，可以通过这些分区管理工具给硬盘格式化和分区。</p>\n<ol>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW51eC5kaWUubmV0L21hbi84L2NmZGlzaw==\">cfdisk</span>，<span class=\"exturl\" data-url=\"aHR0cHM6Ly9tYW4uYXJjaGxpbnV4Lm9yZy9tYW4vY2ZkaXNrLjg=\">Arch Manul cfdisk</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tYW43Lm9yZy9saW51eC9tYW4tcGFnZXMvbWFuOC9mZGlzay44Lmh0bWw=\">fdisk</span>，<span class=\"exturl\" data-url=\"aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvdGl0bGUvRmRpc2s=\">Arch Linux介绍fdisk</span></li>\n</ol>\n<p>一个装载着操作系统的主要设备必须要有根分区，如果使用UEFI引导模式，那还必须得有一个EFI系统分区。</p>\n<h2 id=\"分区样例\"><a href=\"#分区样例\" class=\"headerlink\" title=\"分区样例\"></a>分区样例</h2><ul>\n<li><p>UEFI引导模式，GPT分区表</p>\n<table>\n<thead>\n<tr>\n<th>Mount Point(挂载点)</th>\n<th>Partition(分区)</th>\n<th>Partition Type(分区类型)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&#x2F;mnt&#x2F;boot</td>\n<td>&#x2F;dev&#x2F;efi_system_partition</td>\n<td>EFI System partition</td>\n</tr>\n<tr>\n<td>[SWAP]</td>\n<td>&#x2F;dev&#x2F;swap_partition</td>\n<td>Linux swap</td>\n</tr>\n<tr>\n<td>&#x2F;mnt</td>\n<td>&#x2F;dev&#x2F;root_partition</td>\n<td>Linux x86-64 root(&#x2F;)</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>BIOS引导模式，MBR分区表</p>\n<table>\n<thead>\n<tr>\n<th>Mount Point(挂载点)</th>\n<th>Partition(分区)</th>\n<th>Partition Type(分区类型)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>[SWAP]</td>\n<td>&#x2F;dev&#x2F;swap_partition</td>\n<td>Linux swap</td>\n</tr>\n<tr>\n<td>&#x2F;mnt</td>\n<td>&#x2F;dev&#x2F;root_partition</td>\n<td>Linux</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<h1 id=\"Format-the-partitions\"><a href=\"#Format-the-partitions\" class=\"headerlink\" title=\"Format the partitions\"></a>Format the partitions</h1><p>可通过命令<code>mkfs</code>来创建新的文件系统，关于该文件系统的选择和命令行的使用，可以从官方Wiki<span class=\"exturl\" data-url=\"aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvdGl0bGUvRmlsZV9zeXN0ZW1zI0NyZWF0ZV9hX2ZpbGVfc3lzdGVt\">文件系统</span>了解更多。</p>\n<p>可通过命令<code>mkswap</code>来创建交换分区，用法<code>mkswap /dev/swap_partition</code></p>\n<h1 id=\"Mount-the-file-systems\"><a href=\"#Mount-the-file-systems\" class=\"headerlink\" title=\"Mount the file systems\"></a>Mount the file systems</h1><p>完成分区和格式化以后，就需要挂载设备，挂载点一般是&#x2F;mnt。可通过命令<code>mount &lt;block device identity&gt; &lt;mount point&gt;</code>，例如<code>mount /dev/partition /mnt</code>。</p>\n<h1 id=\"Select-the-mirrors\"><a href=\"#Select-the-mirrors\" class=\"headerlink\" title=\"Select the mirrors\"></a>Select the mirrors</h1><p>通过Linux的文本编辑器打开文件&#x2F;etc&#x2F;pacman.d&#x2F;mirrorlist，根据其中的格式，更换为国内镜像源以得到更好的网络传输速率，已知环境中有的文本编辑器有nano、vi、vim。</p>\n<p>可从Arch Linux官方社区的<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hcmNobGludXgub3JnL21pcnJvcnMv\">镜像列表</span>寻找你想要更换的镜像源。</p>\n<h1 id=\"Install-essential-packages\"><a href=\"#Install-essential-packages\" class=\"headerlink\" title=\"Install essential packages\"></a>Install essential packages</h1><p><code>pacstrap -K /mnt base linux linux-firmware networkmanager dhcpcd netctl</code></p>\n<h1 id=\"Configure-the-system\"><a href=\"#Configure-the-system\" class=\"headerlink\" title=\"Configure the system\"></a>Configure the system</h1><p><code>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code></p>\n<h1 id=\"Chroot\"><a href=\"#Chroot\" class=\"headerlink\" title=\"Chroot\"></a>Chroot</h1><p><code>arch-chroot /mnt</code></p>\n<p>在执行完该命令后我们就处在新的操作系统环境中了，可以趁这个时候安装自己所需要的软件。</p>\n<h1 id=\"Time-zone\"><a href=\"#Time-zone\" class=\"headerlink\" title=\"Time zone\"></a>Time zone</h1><p><code>ln -sf /usr/share/zoneinfo/&lt;region&gt;/&lt;city&gt; /etc/localtime</code></p>\n<p>一般来说设置在上海，所以是<code>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></p>\n<p><code>hwclock --systohc</code></p>\n<h1 id=\"Localization\"><a href=\"#Localization\" class=\"headerlink\" title=\"Localization\"></a>Localization</h1><p>使用文本编辑器打开&#x2F;etc&#x2F;locale&#x2F;gen，去除自己所需语言的注释，一般来说应该有en_US.UTF-8 UTF8、zh_CN.UTF-8 UTF-8、zh_TW.UTF-8 UTF-8，然后执行命令<code>locale-gen</code>来生成本地化文件。</p>\n<p>创建或打开locale.config，写入内容<code>LANG=en_US.UTF-8</code>。</p>\n<p>如果需要改变默认的命令行键盘布局，编辑&#x2F;etc&#x2F;vconsole.conf。</p>\n<h1 id=\"Network-configuration\"><a href=\"#Network-configuration\" class=\"headerlink\" title=\"Network configuration\"></a>Network configuration</h1><p>创建或打开&#x2F;etc&#x2F;hostname，在文件中写入一个自行设定的主机名。</p>\n<p>使用文本编辑器打开&#x2F;etc&#x2F;hosts，在文件中添加内容：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1 localhost</span><br><span class=\"line\">::1 localhost</span><br><span class=\"line\">127.0.1.1 &lt;hostname&gt;.localdomain &lt;hostname&gt;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Root-password\"><a href=\"#Root-password\" class=\"headerlink\" title=\"Root password\"></a>Root password</h1><p>通过命令<code>passwd</code>设置root用户的密码。</p>\n<h1 id=\"Boot-loader\"><a href=\"#Boot-loader\" class=\"headerlink\" title=\"Boot loader\"></a>Boot loader</h1><p>可以选择使用grub作为启动引导，成功后将会显示在自己的BIOS或者UEFI的启动项中。不同启动方式需要的软件包可能有所不同，这里只记录UEFI的情况。</p>\n<p>除了grub，还需要安装efibootmgr、os-prober和ntfs-3g，这两个软件会寻找其他设备中的启动项入口，比如你是双系统能选择启动哪个系统。</p>\n<p>关于grub的使用，可参阅</p>\n<p>主要使用grub-install和grub-mkconfig，先进行grub-install安装，再用grub-mkconfig生成配置文件，安装命令行样例：<code>grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=grub</code>，生成配置文件命令行样例：<code>grub-mkconfig -o /boot/grub/grub.cfg</code>。</p>\n<p>完成后可以重启进入安装完毕的新操作系统Arch Linux了。</p>\n<h2 id=\"Note\"><a href=\"#Note\" class=\"headerlink\" title=\"Note\"></a>Note</h2><p>可以通过查看文件&#x2F;boot&#x2F;grub&#x2F;grub.cfg来检查是否生成了所有你需要的操作系统入口，如果找不到其他操作系统入口比如Windows，可能需要手动编辑该配置文件来添加操作系统入口。</p>\n<p>如果硬件经历了一些变动，导致Arch Linux启动项消失，可以通过重新配置系统和重新配置启动引导来恢复正常。</p>\n<h1 id=\"Add-new-user\"><a href=\"#Add-new-user\" class=\"headerlink\" title=\"Add new user\"></a>Add new user</h1><p>可通过命令<code>useradd</code>来添加新的用户，例如：<code>useradd -m -G wheel &lt;username&gt;</code></p>\n<p>可通过命令<code>passwd</code>来给新用户设置密码，例如：<code>passwrd &lt;username&gt;</code></p>\n<h1 id=\"Graphic-user-interface\"><a href=\"#Graphic-user-interface\" class=\"headerlink\" title=\"Graphic user interface\"></a>Graphic user interface</h1><p>可选择安装Xorg提供图形服务，有关Xorg和图形处理器驱动的安装和相关详情，需阅读<span class=\"exturl\" data-url=\"aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvdGl0bGUvWG9yZyNEcml2ZXJfaW5zdGFsbGF0aW9u\">Xorg</span></p>\n<h1 id=\"Desktop-environment\"><a href=\"#Desktop-environment\" class=\"headerlink\" title=\"Desktop environment\"></a>Desktop environment</h1><p>可从多个Linux<span class=\"exturl\" data-url=\"aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvdGl0bGUvRGVza3RvcF9lbnZpcm9ubWVudA==\">桌面环境</span>中选择一个安装。</p>\n<h1 id=\"Display-Manager\"><a href=\"#Display-Manager\" class=\"headerlink\" title=\"Display Manager\"></a>Display Manager</h1><p>可从多个<span class=\"exturl\" data-url=\"aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvdGl0bGUvRGlzcGxheV9tYW5hZ2Vy\">显示管理器</span>中选择一个安装。</p>\n<h1 id=\"Arch-User-Repository\"><a href=\"#Arch-User-Repository\" class=\"headerlink\" title=\"Arch User Repository\"></a>Arch User Repository</h1><p>AUR是Arch Linux的灵魂之一，大多数不存在官方镜像源中的软件都可以从这里获取，由于AUR的存在使得Arch Linux的软件生态比其他发行版更为健壮。</p>\n<h1 id=\"Note-1\"><a href=\"#Note-1\" class=\"headerlink\" title=\"Note\"></a>Note</h1><p>Arch Linux的官方社区相当活跃，Wiki也很齐全，大部分问题或者疑惑都可以通过查阅Wiki解答，也可以去社区Newbie模块发帖询问。当Arch Linux用多了以后也能给予一点点开源的贡献了，开源的魅力会逐渐显现。</p>\n<p>（在Arch Linux上玩Minecraft时有需求过一个地图编辑器Amulet，发现缺少依赖，反馈了这个问题，发布者给它修了）</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><ol>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvdGl0bGUvSW5zdGFsbGF0aW9uX2d1aWRl\">Installation guide - ArchWiki</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmlzZWF0b3IuY29tLzIwMTcvMDUvMTcvYXJjaF9pbnN0YWxsLw==\">以官方Wiki的方式安装ArchLinux - Viseator’s blog</span></li>\n</ol>\n",
            "tags": []
        }
    ]
}